{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": { "type": "grafana", "uid": "-- Grafana --" },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 26,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "id": 4,
      "panels": [],
      "title": "Sensor-01",
      "type": "row"
    },
    {
      "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
      "description": "ESP1 temperature (auto-aggregated by $__interval).",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds", "seriesBy": "last" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 13,
            "gradientMode": "scheme",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "insertNulls": 14400000,
            "lineInterpolation": "smooth",
            "lineStyle": { "fill": "solid" },
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "dashed" }
          },
          "fieldMinMax": false,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": 0 },
              { "color": "green", "value": 69 },
              { "color": "#EAB839", "value": 75 },
              { "color": "red", "value": 78 }
            ]
          },
          "unit": "degree"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 1 },
      "id": 1,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "timezone": ["browser"],
        "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
      },
      "pluginVersion": "12.3.0-18940657299.patch4",
      "targets": [
        {
          "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
          "format": "table",
          "hide": false,
          "range": true,
          "rawSql": "select\n  $__timeGroupAlias(recorded_at, $__interval),\n  avg(temperature_c * 9.0/5.0 + 32) as temperature_f\nfrom public.readings\nwhere device_id = 'esp32-lab-01'\n  and $__timeFilter(recorded_at)\ngroup by 1\norder by 1;",
          "refId": "A"
        }
      ],
      "title": "ESP1 Temp Sensor",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
      "description": "ESP1 humidity (auto-aggregated by $__interval).",
      "fieldConfig": {
        "defaults": {
          "color": { "fixedColor": "blue", "mode": "shades", "seriesBy": "max" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 7,
            "gradientMode": "hue",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "insertNulls": 14400000,
            "lineInterpolation": "smooth",
            "lineStyle": { "fill": "solid" },
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "line" }
          },
          "mappings": [],
          "min": 0,
          "thresholds": { "mode": "percentage", "steps": [{ "color": "green", "value": 0 }] },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": { "h": 6, "w": 24, "x": 0, "y": 9 },
      "id": 2,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
      },
      "pluginVersion": "12.3.0-18940657299.patch4",
      "targets": [
        {
          "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
          "format": "table",
          "hide": false,
          "range": true,
          "rawSql": "select\n  $__timeGroupAlias(recorded_at, $__interval),\n  avg(humidity_rh) as humidity_pct\nfrom public.readings\nwhere device_id = 'esp32-lab-01'\n  and $__timeFilter(recorded_at)\ngroup by 1\norder by 1;",
          "refId": "A"
        }
      ],
      "title": "Humidity %",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
      "description": "ESP1 pressure (auto-aggregated by $__interval).",
      "fieldConfig": {
        "defaults": {
          "color": { "fixedColor": "blue", "mode": "shades", "seriesBy": "max" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisPlacement": "auto",
            "axisSoftMin": 820,
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "bars",
            "fillOpacity": 7,
            "gradientMode": "hue",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "insertNulls": 14400000,
            "lineInterpolation": "smooth",
            "lineStyle": { "fill": "solid" },
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "line" }
          },
          "fieldMinMax": true,
          "mappings": [],
          "min": 0,
          "thresholds": { "mode": "percentage", "steps": [{ "color": "green", "value": 0 }] },
          "unit": "pressurehpa"
        },
        "overrides": []
      },
      "gridPos": { "h": 6, "w": 24, "x": 0, "y": 15 },
      "id": 3,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "timezone": ["browser"],
        "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
      },
      "pluginVersion": "12.3.0-18940657299.patch4",
      "targets": [
        {
          "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
          "format": "table",
          "hide": false,
          "range": true,
          "rawSql": "select\n  $__timeGroupAlias(recorded_at, $__interval),\n  avg(pressure_hpa) as pressure_hpa\nfrom public.readings\nwhere device_id = 'esp32-lab-01'\n  and $__timeFilter(recorded_at)\ngroup by 1\norder by 1;",
          "refId": "A"
        }
      ],
      "title": "Pressure (hPa)",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": { "type": "grafana-postgresql-datasource", "uid": "cevubk3nbq4g0a" },
      "description": "Count of warning and error events grouped by severity (already interval-aware).",
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "bars",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 6,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "normal" },
            "thresholdsStyle": { "mode": "off" }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": 0 }, { "color": "red", "value": 80 }]
          }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "warning" },
            "properties": [{ "id": "color", "value": { "fixedColor": "orange", "mode": "fixed" } }]
          },
          {
            "matcher": { "id": "byName", "options": "error" },
            "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }]
          }
        ]
      },
      "gridPos": { "h": 6, "w": 24, "x": 0, "y": 21 },
      "id": 5,
      "options": {
        "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
        "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
      },
      "pluginVersion": "12.3.0-18940657299.patch4",
      "targets": [
        {
          "dataset": "postgres",
          "editorMode": "code",
          "format": "time_series",
          "rawQuery": true,
          "rawSql": "SELECT\n  $__timeGroup(created_at, $__interval) AS time,\n  severity AS metric,\n  COUNT(*) AS value\nFROM device_events\nWHERE\n  $__timeFilter(created_at)\n  AND severity IN ('warning','error')\nGROUP BY time, severity\nORDER BY time, severity;",
          "refId": "A"
        }
      ],
      "title": "Warnings and Errors Over Time",
      "transparent": true,
      "type": "timeseries"
    }
  ],
  "preload": false,
  "refresh": false,
  "schemaVersion": 42,
  "tags": [],
  "templating": { "list": [] },
  "time": { "from": "now-30d", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "ESP32 Sensors",
  "uid": "poq8xmq",
  "version": 28
}
